<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>üåê Website Monitoring - FindLead Dashboard</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.1.1/css/all.min.css">
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap');
        :root {
            --primary-color: #764ba2; --secondary-color: #667eea;
            --primary-gradient: linear-gradient(135deg, var(--secondary-color) 0%, var(--primary-color) 100%);
            --glass-bg: rgba(255, 255, 255, 0.08); --card-bg: rgba(30, 41, 59, 0.75);
            --text-primary: #f8fafc; --text-secondary: rgba(248, 250, 252, 0.8); --text-muted: rgba(248, 250, 252, 0.65);
            --success: #10b981; --danger: #ef4444; --info: #3b82f6;
            --border-color: rgba(255, 255, 255, 0.15); --shadow-lg: 0 10px 30px -5px rgba(0, 0, 0, 0.3);
            --border-radius-lg: 24px; --border-radius-md: 16px;
        }
        body { background-color: #111827; background-image: var(--primary-gradient); min-height: 100vh; font-family: 'Inter', system-ui, sans-serif; color: var(--text-primary); }
        .navbar { background: rgba(0, 0, 0, 0.2) !important; backdrop-filter: blur(15px); border-bottom: 1px solid var(--border-color); }
        .glass-card { background: var(--glass-bg); backdrop-filter: blur(20px); border-radius: var(--border-radius-lg); border: 1px solid var(--border-color); box-shadow: var(--shadow-lg); transition: all 0.3s ease; }
        .glass-card:hover { transform: translateY(-5px); box-shadow: 0 20px 40px -10px rgba(0, 0, 0, 0.4); border-color: rgba(255, 255, 255, 0.25); }
        .page-header { background: var(--card-bg); border-radius: var(--border-radius-lg); padding: 3rem; }
        .page-header .icon { font-size: 3.5rem; margin-bottom: 1rem; color: var(--secondary-color); filter: drop-shadow(0 0 15px var(--secondary-color)); }
        .btn-primary { background: var(--primary-gradient); border: none; border-radius: 50px; padding: 12px 30px; font-weight: 600; text-transform: uppercase; letter-spacing: 1px; transition: all 0.3s ease; box-shadow: 0 4px 15px rgba(102, 126, 234, 0.3); }
        .btn-primary:hover { transform: translateY(-2px); box-shadow: 0 8px 25px rgba(102, 126, 234, 0.4); }
        .form-label { color: var(--text-secondary); font-weight: 500; }
        .form-control, .form-select { 
            background: rgba(255, 255, 255, 0.05) !important; 
            border: 1px solid var(--border-color) !important; 
            border-radius: 12px !important; 
            color: var(--text-primary) !important; 
            padding: 12px 16px !important; 
            transition: all 0.3s ease !important; 
        }
        .form-control:focus, .form-select:focus { 
            background: rgba(255, 255, 255, 0.1) !important; 
            border-color: var(--secondary-color) !important; 
            box-shadow: 0 0 0 3px rgba(102, 126, 234, 0.2) !important; 
            color: var(--text-primary) !important; 
        }
        .form-control::placeholder { color: var(--text-muted); }
        .form-select { 
            background-image: url("data:image/svg+xml,%3csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 16 16'%3e%3cpath fill='none' stroke='rgba(248, 250, 252, 0.65)' stroke-linecap='round' stroke-linejoin='round' stroke-width='2' d='m2 5 6 6 6-6'/%3e%3c/svg%3e") !important;
            background-repeat: no-repeat !important;
            background-position: right 0.75rem center !important;
            background-size: 16px 12px !important;
        }
        .form-select option { 
            background-color: #1e293b !important; 
            color: var(--text-primary) !important;
            padding: 10px !important;
        }
        .form-select::-ms-expand {
            display: none;
        }
        .text-purple { color: #a855f7 !important; }
        .loading-spinner { 
            display: inline-block; 
            width: 20px; 
            height: 20px; 
            border: 3px solid rgba(255, 255, 255, 0.3); 
            border-radius: 50%; 
            border-top-color: white; 
            animation: spin 1s ease-in-out infinite; 
            vertical-align: middle; 
        }
        @keyframes spin { to { transform: rotate(360deg); } }
        .loading-spinner { border: 2px solid rgba(255, 255, 255, 0.3); border-radius: 50%; border-top: 2px solid var(--secondary-color); width: 20px; height: 20px; animation: spin 1s linear infinite; display: inline-block; }
        h1, .h1, h2, .h2, h3, .h3, h4, .h4 { font-weight: 700; }
    </style>
</head>
<body>
    <nav class="navbar navbar-expand-lg navbar-dark sticky-top">
        <div class="container">
            <a class="navbar-brand fw-bold fs-3" href="/"><i class="fas fa-robot me-2"></i> FindLead Dashboard</a>
            <div class="navbar-nav ms-auto">
                <a class="nav-link" href="/">üè† Dashboard</a>
                <a class="nav-link" href="/sentiment">üòä Sentiment Analysis</a>
                <a class="nav-link" href="/email-validation">üìß Email Security</a>
                <a class="nav-link active" href="/website-monitoring">üåê Website Monitoring</a>
            </div>
        </div>
    </nav>
    <div class="container my-5">
        <div class="row justify-content-center mb-5">
            <div class="col-lg-10">
                <div class="page-header text-center">
                    <div class="icon"><i class="fas fa-chart-line"></i></div>
                    <h1 class="display-4 fw-bold mb-3">Website Monitoring</h1>
                    <p class="lead text-light mb-4">Real-time Performance & Security Monitoring with FindLead Agents</p>
                    <div class="glass-card p-4 mt-4">
                        <h4><i class="fas fa-info-circle me-2"></i>What This Does (In Simple Terms)</h4>
                        <p class="text-light mb-3">
                            Like having a digital assistant that watches websites 24/7 and alerts you when something important changes. 
                            Perfect for monitoring competitor prices, job postings, product launches, or any website updates you care about.
                        </p>
                        <div class="row text-center">
                            <div class="col-md-3">
                                <h6 class="text-success"><i class="fas fa-eye me-1"></i> Change Detection</h6>
                                <small>Spots Any Updates</small>
                            </div>
                            <div class="col-md-3">
                                <h6 class="text-info"><i class="fas fa-tachometer-alt me-1"></i> Performance Check</h6>
                                <small>Speed & Uptime</small>
                            </div>
                            <div class="col-md-3">
                                <h6 class="text-warning"><i class="fas fa-shield-virus me-1"></i> Security Scan</h6>
                                <small>Malware & Threats</small>
                            </div>
                            <div class="col-md-3">
                                <h6 class="text-purple"><i class="fas fa-bell me-1"></i> Smart Alerts</h6>
                                <small>Important Changes Only</small>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <div class="row justify-content-center">
            <div class="col-lg-10">
                <div class="glass-card p-4 p-md-5">
                    <form id="monitorForm">
                        <div class="row">
                            <div class="col-12 mb-4">
                                <label for="websiteUrl" class="form-label"><i class="fas fa-link me-2"></i>Website URL</label>
                                <input type="url" class="form-control" id="websiteUrl" placeholder="https://example.com" required>
                            </div>
                        </div>
                        <div class="text-center">
                            <button type="submit" class="btn btn-primary btn-lg w-100">
                                <i class="fas fa-play-circle me-2"></i>Start Monitoring
                            </button>
                        </div>
                    </form>
                    
                    <!-- Results Section -->
                    <div id="resultCard" class="mt-5" style="display: none;">
                        <h3 class="text-center mb-4"><i class="fas fa-chart-line me-2"></i>Monitoring Results</h3>
                        <div class="glass-card p-4" id="monitoringResults"></div>
                    </div>
                </div>
            </div>
        </div>
        
        <!-- Examples Section - Always Visible -->
        <div class="row justify-content-center mt-5">
            <div class="col-lg-10">
                <div class="glass-card p-4">
                    <h3 class="text-center mb-4"><i class="fas fa-lightbulb me-2"></i>Try These Examples</h3>
                    <div class="glass-card p-3" style="background: rgba(120, 75, 162, 0.1); border-color: rgba(120, 75, 162, 0.3);">
                        <h5 class="text-warning mb-3"><i class="fas fa-lightbulb me-2"></i>Example Websites to Monitor:</h5>
                        <div class="row g-3">
                            <div class="col-md-6">
                                <div class="d-flex justify-content-between align-items-center">
                                    <div>
                                        <p class="text-white mb-1"><strong>Competitor Pricing:</strong></p>
                                        <small class="text-light opacity-75">https://competitor.com/pricing</small>
                                    </div>
                                    <button class="btn btn-sm btn-primary" onclick="loadExample('https://competitor.com/pricing')">Load</button>
                                </div>
                            </div>
                            <div class="col-md-6">
                                <div class="d-flex justify-content-between align-items-center">
                                    <div>
                                        <p class="text-white mb-1"><strong>Job Postings:</strong></p>
                                        <small class="text-light opacity-75">https://company.com/careers</small>
                                    </div>
                                    <button class="btn btn-sm btn-primary" onclick="loadExample('https://company.com/careers')">Load</button>
                                </div>
                            </div>
                            <div class="col-md-6">
                                <div class="d-flex justify-content-between align-items-center">
                                    <div>
                                        <p class="text-white mb-1"><strong>Product Launches:</strong></p>
                                        <small class="text-light opacity-75">https://apple.com</small>
                                    </div>
                                    <button class="btn btn-sm btn-primary" onclick="loadExample('https://apple.com')">Load</button>
                                </div>
                            </div>
                            <div class="col-md-6">
                                <div class="d-flex justify-content-between align-items-center">
                                    <div>
                                        <p class="text-white mb-1"><strong>News Updates:</strong></p>
                                        <small class="text-light opacity-75">https://techcrunch.com</small>
                                    </div>
                                    <button class="btn btn-sm btn-primary" onclick="loadExample('https://techcrunch.com')">Load</button>
                                </div>
                            </div>
                        </div>
                        <small class="text-white mt-3 d-block"><strong>Our AI will:</strong> Detect meaningful changes, ignore minor updates, and send you smart alerts!</small>
                    </div>
                </div>
            </div>
        </div>
    </div>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/js/bootstrap.bundle.min.js"></script>
    <script>
        document.addEventListener('DOMContentLoaded', function() {
            // Form submission handler
            document.getElementById('monitorForm').addEventListener('submit', async function(e) {
                e.preventDefault();
                
                const websiteUrl = document.getElementById('websiteUrl').value;
                const resultCard = document.getElementById('resultCard');
                const resultsDiv = document.getElementById('monitoringResults');
                const submitBtn = document.querySelector('#monitorForm button[type="submit"]');
                const originalBtnText = submitBtn.innerHTML;
                
                // Show loading state
                submitBtn.innerHTML = '<span class="loading-spinner me-2" style="width: 16px; height: 16px;"></span>Monitoring...';
                submitBtn.disabled = true;
                
                resultsDiv.innerHTML = `
                    <div class="text-center py-4">
                        <div class="loading-spinner mb-3" style="width: 30px; height: 30px;"></div>
                        <p class="text-secondary">CrewAI monitoring agents are analyzing your website...</p>
                        <small class="text-light opacity-75">This may take 15-30 seconds for real AI analysis</small>
                    </div>
                `;
                resultCard.style.display = 'block';
                
                try {
                    // Call the real CrewAI backend for website monitoring
                    const response = await fetch('/api/monitor-website', {
                        method: 'POST',
                        headers: {
                            'Content-Type': 'application/json'
                        },
                        body: JSON.stringify({ 
                            url: websiteUrl
                        })
                    });
                    
                    if (!response.ok) {
                        throw new Error(`HTTP ${response.status}: ${response.statusText}`);
                    }
                    
                    const result = await response.json();
                    
                    // Display AI analysis results
                    const analysis = result.analysis || {};
                    const rawAnalysis = analysis.raw_analysis || {};
                    const scores = rawAnalysis.scores || {};
                    const telemetry = analysis.telemetry || {};
                    
                    resultsDiv.innerHTML = `
                        <div class="row g-3">
                            <div class="col-md-6">
                                <h6><i class="fas fa-globe me-2"></i>Website Status</h6>
                                <p class="text-success mb-1">${telemetry.status_code ? 'completed' : '‚úÖ Online'}</p>
                                <small class="text-light opacity-75">${telemetry.latency_ms ? telemetry.latency_ms + 'ms' : 'Response analyzed by AI'}</small>
                            </div>
                            <div class="col-md-6">
                                <h6><i class="fas fa-shield-alt me-2"></i>Security Score</h6>
                                <p class="text-info mb-1">${analysis.security_score || scores.security || 'N/A'}/100</p>
                                <small class="text-light opacity-75">AI security analysis</small>
                            </div>
                            <div class="col-md-6">
                                <h6><i class="fas fa-tachometer-alt me-2"></i>Performance</h6>
                                <p class="text-success mb-1">üìä ${scores.performance || 'Good'}</p>
                                <small class="text-light opacity-75">AI performance analysis</small>
                            </div>
                            <div class="col-md-6">
                                <h6><i class="fas fa-mobile-alt me-2"></i>Accessibility</h6>
                                <p class="text-info mb-1">‚úÖ ${scores.accessibility || 'Responsive'}</p>
                                <small class="text-light opacity-75">AI accessibility check</small>
                            </div>
                        </div>
                        
                        <hr style="border-color: rgba(255, 255, 255, 0.2);" class="my-3">
                        <div class="glass-card p-3" style="background: rgba(16, 185, 129, 0.1); border-color: rgba(16, 185, 129, 0.3);">
                            <h6 class="text-success mb-2"><i class="fas fa-chart-line me-2"></i>AI Monitoring Analysis:</h6>
                            <div class="small text-light">
                                ${rawAnalysis.summary || analysis.summary || 'Website monitoring completed by CrewAI agents'}
                                ${analysis.recommendations && analysis.recommendations.length > 0 ? '<br><br><strong>Recommendations:</strong><br>‚Ä¢ ' + analysis.recommendations.join('<br>‚Ä¢ ') : ''}
                            </div>
                        </div>
                    `;
                    
                } catch (error) {
                    console.error('Monitoring error:', error);
                    resultsDiv.innerHTML = `
                        <div class="text-center py-4">
                            <p class="text-danger"><i class="fas fa-exclamation-triangle me-2"></i>Monitoring Failed</p>
                            <p class="text-light opacity-75 small">Error: ${error.message}</p>
                            <p class="text-light opacity-75 small">Please check that the backend server is running and try again.</p>
                        </div>
                    `;
                } finally {
                    // Restore button
                    submitBtn.innerHTML = originalBtnText;
                    submitBtn.disabled = false;
                }
            });
        });
        
        function generateMonitoringResults(url, type) {
            const domain = new URL(url).hostname;
            const isSecure = url.startsWith('https://');
            
            let baseResults = `
                <div class="row g-3">
                    <div class="col-md-6">
                        <h6><i class="fas fa-globe me-2"></i>Website Status</h6>
                        <p class="text-success mb-1">‚úÖ Online</p>
                        <small class="text-light opacity-75">Response time: 245ms</small>
                    </div>
                    <div class="col-md-6">
                        <h6><i class="fas fa-shield-alt me-2"></i>Security</h6>
                        <p class="${isSecure ? 'text-success' : 'text-warning'} mb-1">
                            ${isSecure ? '‚úÖ HTTPS Enabled' : '‚ö†Ô∏è HTTP Only'}
                        </p>
                        <small class="text-light opacity-75">SSL Certificate: ${isSecure ? 'Valid' : 'Not Found'}</small>
                    </div>
            `;
            
            // Add type-specific results
            switch(type) {
                case 'performance':
                    baseResults += `
                        <div class="col-md-6">
                            <h6><i class="fas fa-tachometer-alt me-2"></i>Performance Score</h6>
                            <p class="text-info mb-1">üìä 85/100</p>
                            <small class="text-light opacity-75">Load time: 1.2s</small>
                        </div>
                        <div class="col-md-6">
                            <h6><i class="fas fa-mobile-alt me-2"></i>Mobile Friendly</h6>
                            <p class="text-success mb-1">‚úÖ Responsive</p>
                            <small class="text-light opacity-75">All devices supported</small>
                        </div>
                    `;
                    break;
                case 'security':
                    baseResults += `
                        <div class="col-md-6">
                            <h6><i class="fas fa-virus me-2"></i>Malware Scan</h6>
                            <p class="text-success mb-1">‚úÖ Clean</p>
                            <small class="text-light opacity-75">No threats detected</small>
                        </div>
                        <div class="col-md-6">
                            <h6><i class="fas fa-user-shield me-2"></i>Privacy Score</h6>
                            <p class="text-info mb-1">üîí B+ Rating</p>
                            <small class="text-light opacity-75">Good privacy practices</small>
                        </div>
                    `;
                    break;
                case 'comprehensive':
                    baseResults += `
                        <div class="col-md-6">
                            <h6><i class="fas fa-chart-bar me-2"></i>SEO Score</h6>
                            <p class="text-success mb-1">üìà 92/100</p>
                            <small class="text-light opacity-75">Well optimized</small>
                        </div>
                        <div class="col-md-6">
                            <h6><i class="fas fa-eye me-2"></i>Change Detection</h6>
                            <p class="text-info mb-1">üîç Active</p>
                            <small class="text-light opacity-75">Monitoring enabled</small>
                        </div>
                    `;
                    break;
                default:
                    baseResults += `
                        <div class="col-md-12">
                            <h6><i class="fas fa-check me-2"></i>Basic Health Check</h6>
                            <p class="text-success mb-1">‚úÖ Website is accessible and responding normally</p>
                            <small class="text-light opacity-75">Basic monitoring active</small>
                        </div>
                    `;
            }
            
            baseResults += `
                </div>
                <hr class="my-4" style="border-color: rgba(255, 255, 255, 0.2);">
                <div class="text-center">
                    <p class="text-info mb-2">
                        <i class="fas fa-bell me-2"></i>
                        <strong>Monitoring Active</strong>
                    </p>
                    <small class="text-light opacity-75">
                        You'll receive alerts when significant changes are detected on ${domain}
                    </small>
                    <div class="glass-card p-3 mt-3" style="background: rgba(120, 75, 162, 0.1); border-color: rgba(120, 75, 162, 0.3);">
                        <h6 class="text-warning mb-2"><i class="fas fa-tasks me-2"></i>Monitoring Summary:</h6>
                        <ul class="list-unstyled mb-0 small text-light">
                            <li>‚Ä¢ <strong>Status:</strong> Active monitoring enabled for ${domain}</li>
                            <li>‚Ä¢ <strong>Check Frequency:</strong> Every 15 minutes</li>
                            <li>‚Ä¢ <strong>Alerts:</strong> Email notifications for significant changes</li>
                            <li>‚Ä¢ <strong>Dashboard:</strong> Real-time updates available in reports section</li>
                        </ul>
                    </div>
                </div>
            `;
            
            return baseResults;
        }
        
        // Load example into form
        function loadExample(url) {
            document.getElementById('websiteUrl').value = url;
            
            // Scroll to form
            document.getElementById('monitorForm').scrollIntoView({ behavior: 'smooth' });
        }
    </script>
</body>
</html>

